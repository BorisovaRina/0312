using System;
using System.Data;
using System.Collections.Generic;
using System.Linq;

class Program
{
    static void Main()
    {
        try
        {
            DataSet ds = CreateUniversityDataSet();
            FillTestData(ds);
            CreateUniversityRelationships(ds);
            
            Console.WriteLine("=== Ğ—ĞĞ”ĞĞĞ˜Ğ• 19: Ğ£ĞŸĞ ĞĞ’Ğ›Ğ•ĞĞ˜Ğ• ĞĞ‘Ğ ĞĞ—ĞĞ’ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ«Ğœ Ğ£Ğ§Ğ Ğ•Ğ–Ğ”Ğ•ĞĞ˜Ğ•Ğœ ===\n");
            
            Console.WriteLine("1. Ğ˜Ğ¡Ğ¥ĞĞ”ĞĞĞ¯ Ğ¡Ğ¢Ğ Ğ£ĞšĞ¢Ğ£Ğ Ğ:");
            PrintUniversityHierarchy(ds);
            Console.WriteLine();
            
            Console.WriteLine("2. ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ˜:");
            PerformUniversityOperations(ds);
            Console.WriteLine();
            
            Console.WriteLine("3. ĞĞ¢Ğ§ĞĞ¢Ğ«:");
            GenerateUniversityReports(ds);
            Console.WriteLine();
            
            Console.WriteLine("4. ĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ Ğ¦Ğ•Ğ›ĞĞ¡Ğ¢ĞĞĞ¡Ğ¢Ğ˜ ĞŸĞ•Ğ Ğ•Ğ” Ğ¡ĞĞ¥Ğ ĞĞĞ•ĞĞ˜Ğ•Ğœ:");
            CheckUniversityIntegrity(ds);
        }
        catch (Exception ex)
        {
            Console.WriteLine($"ĞĞ¨Ğ˜Ğ‘ĞšĞ: {ex.Message}");
        }
    }
    
    static DataSet CreateUniversityDataSet()
    {
        DataSet ds = new DataSet("UniversityDB");
        
        // Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹
        DataTable faculties = new DataTable("Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹");
        faculties.Columns.Add("FacultyID", typeof(int));
        faculties.Columns.Add("FacultyName", typeof(string));
        faculties.PrimaryKey = new DataColumn[] { faculties.Columns["FacultyID"] };
        
        // Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
        DataTable specialties = new DataTable("Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸");
        specialties.Columns.Add("SpecialtyID", typeof(int));
        specialties.Columns.Add("SpecialtyName", typeof(string));
        specialties.Columns.Add("FacultyID", typeof(int));
        specialties.PrimaryKey = new DataColumn[] { specialties.Columns["SpecialtyID"] };
        
        // Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹
        DataTable students = new DataTable("Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹");
        students.Columns.Add("StudentID", typeof(int));
        students.Columns.Add("StudentName", typeof(string));
        students.Columns.Add("SpecialtyID", typeof(int));
        students.PrimaryKey = new DataColumn[] { students.Columns["StudentID"] };
        
        // ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹
        DataTable subjects = new DataTable("ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹");
        subjects.Columns.Add("SubjectID", typeof(int));
        subjects.Columns.Add("SubjectName", typeof(string));
        subjects.PrimaryKey = new DataColumn[] { subjects.Columns["SubjectID"] };
        
        // ĞÑ†ĞµĞ½ĞºĞ¸
        DataTable grades = new DataTable("ĞÑ†ĞµĞ½ĞºĞ¸");
        grades.Columns.Add("GradeID", typeof(int));
        grades.Columns.Add("StudentID", typeof(int));
        grades.Columns.Add("SubjectID", typeof(int));
        grades.Columns.Add("Grade", typeof(double));
        grades.Columns.Add("Date", typeof(DateTime));
        grades.PrimaryKey = new DataColumn[] { grades.Columns["GradeID"] };
        
        ds.Tables.AddRange(new DataTable[] { faculties, specialties, students, subjects, grades });
        return ds;
    }
    
    static void FillTestData(DataSet ds)
    {
        DataTable faculties = ds.Tables["Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹"];
        DataTable specialties = ds.Tables["Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"];
        DataTable students = ds.Tables["Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹"];
        DataTable subjects = ds.Tables["ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹"];
        DataTable grades = ds.Tables["ĞÑ†ĞµĞ½ĞºĞ¸"];
        
        // Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹
        faculties.Rows.Add(1, "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸ĞºĞ°");
        faculties.Rows.Add(2, "Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸ĞºĞ°");
        
        // Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
        specialties.Rows.Add(101, "ĞŸÑ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ğ°Ñ Ğ¸Ğ½Ğ¶ĞµĞ½ĞµÑ€Ğ¸Ñ", 1);
        specialties.Rows.Add(102, "Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ", 1);
        specialties.Rows.Add(201, "Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑÑ‹", 2);
        
        // Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹
        students.Rows.Add(1001, "Ğ˜Ğ²Ğ°Ğ½ ĞŸĞµÑ‚Ñ€Ğ¾Ğ²", 101);
        students.Rows.Add(1002, "ĞœĞ°Ñ€Ğ¸Ñ Ğ¡Ğ¸Ğ´Ğ¾Ñ€Ğ¾Ğ²Ğ°", 101);
        students.Rows.Add(1003, "ĞĞ»ĞµĞºÑĞµĞ¹ ĞĞ¾Ğ²Ğ¸ĞºĞ¾Ğ²", 102);
        students.Rows.Add(1004, "Ğ•Ğ»ĞµĞ½Ğ° ĞšĞ¾Ğ·Ğ»Ğ¾Ğ²Ğ°", 201);
        
        // ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹
        subjects.Rows.Add(1, "C# Programming");
        subjects.Rows.Add(2, "Databases");
        subjects.Rows.Add(3, "Web Development");
        subjects.Rows.Add(4, "Algorithms");
        
        // ĞÑ†ĞµĞ½ĞºĞ¸
        grades.Rows.Add(1, 1001, 1, 4.5, new DateTime(2024, 12, 1));
        grades.Rows.Add(2, 1001, 2, 4.2, new DateTime(2024, 12, 5));
        grades.Rows.Add(3, 1001, 3, 4.8, new DateTime(2024, 12, 10));
        grades.Rows.Add(4, 1002, 1, 4.7, new DateTime(2024, 12, 1));
        grades.Rows.Add(5, 1002, 4, 3.9, new DateTime(2024, 12, 8));
        grades.Rows.Add(6, 1003, 2, 4.0, new DateTime(2024, 12, 5));
        grades.Rows.Add(7, 1003, 3, 4.3, new DateTime(2024, 12, 10));
        grades.Rows.Add(8, 1004, 1, 3.8, new DateTime(2024, 12, 1));
        grades.Rows.Add(9, 1004, 4, 4.1, new DateTime(2024, 12, 8));
    }
    
    static void CreateUniversityRelationships(DataSet ds)
    {
        DataTable faculties = ds.Tables["Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹"];
        DataTable specialties = ds.Tables["Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"];
        DataTable students = ds.Tables["Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹"];
        DataTable subjects = ds.Tables["ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹"];
        DataTable grades = ds.Tables["ĞÑ†ĞµĞ½ĞºĞ¸"];
        
        // Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹ â†’ Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ (Cascade Delete/Update)
        ForeignKeyConstraint fk1 = new ForeignKeyConstraint("FK_Specialties_Faculties",
            faculties.Columns["FacultyID"], specialties.Columns["FacultyID"]);
        fk1.DeleteRule = Rule.Cascade;
        fk1.UpdateRule = Rule.Cascade;
        specialties.Constraints.Add(fk1);
        ds.Relations.Add(new DataRelation("Rel_Faculties_Specialties",
            faculties.Columns["FacultyID"], specialties.Columns["FacultyID"]));
        
        // Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ â†’ Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹ (SetNull Delete, Cascade Update)
        ForeignKeyConstraint fk2 = new ForeignKeyConstraint("FK_Students_Specialties",
            specialties.Columns["SpecialtyID"], students.Columns["SpecialtyID"]);
        fk2.DeleteRule = Rule.SetNull;
        fk2.UpdateRule = Rule.Cascade;
        students.Constraints.Add(fk2);
        ds.Relations.Add(new DataRelation("Rel_Specialties_Students",
            specialties.Columns["SpecialtyID"], students.Columns["SpecialtyID"]));
        
        // Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹ â†’ ĞÑ†ĞµĞ½ĞºĞ¸
        ForeignKeyConstraint fk3 = new ForeignKeyConstraint("FK_Grades_Students",
            students.Columns["StudentID"], grades.Columns["StudentID"]);
        grades.Constraints.Add(fk3);
        ds.Relations.Add(new DataRelation("Rel_Students_Grades",
            students.Columns["StudentID"], grades.Columns["StudentID"]));
        
        // ĞŸÑ€ĞµĞ´Ğ¼ĞµÑ‚Ñ‹ â†’ ĞÑ†ĞµĞ½ĞºĞ¸
        ForeignKeyConstraint fk4 = new ForeignKeyConstraint("FK_Grades_Subjects",
            subjects.Columns["SubjectID"], grades.Columns["SubjectID"]);
        grades.Constraints.Add(fk4);
        ds.Relations.Add(new DataRelation("Rel_Subjects_Grades",
            subjects.Columns["SubjectID"], grades.Columns["SubjectID"]));
    }
    
    static void PerformUniversityOperations(DataSet ds)
    {
        Console.WriteLine("=== ĞĞŸĞ•Ğ ĞĞ¦Ğ˜Ğ˜ ===");
        
        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ¾Ğ²Ğ¾Ğ¹ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
        DataTable specialties = ds.Tables["Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"];
        specialties.Rows.Add(103, "Ğ˜Ğ˜ Ğ¸ ML", 1);
        Console.WriteLine("âœ“ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ° ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ 'Ğ˜Ğ˜ Ğ¸ ML'");
        
        // Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ°
        DataTable students = ds.Tables["Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹"];
        students.Rows.Add(1005, "ĞĞ¾Ğ²Ñ‹Ğ¹ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚", 103);
        Console.WriteLine("âœ“ Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚ Ğ½Ğ° Ğ½Ğ¾Ğ²ÑƒÑ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ");
        
        // ĞšĞ°ÑĞºĞ°Ğ´Ğ½Ğ¾Ğµ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ğ° (Ñ‚ĞµÑÑ‚)
        Console.WriteLine("\nĞšĞĞ¡ĞšĞĞ”ĞĞĞ• Ğ£Ğ”ĞĞ›Ğ•ĞĞ˜Ğ• Ğ¤ĞĞšĞ£Ğ›Ğ¬Ğ¢Ğ•Ğ¢Ğ #2 (Ğ­ĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸ĞºĞ°):");
        DataTable faculties = ds.Tables["Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹"];
        DataRow faculty2 = faculties.Rows.Find(2);
        faculty2.Delete();
        Console.WriteLine("âœ“ Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚ ÑƒĞ´Ğ°Ğ»Ñ‘Ğ½ â†’ ĞºĞ°ÑĞºĞ°Ğ´Ğ½Ğ¾ ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ° ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ 'Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑÑ‹'");
        Console.WriteLine("  Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚ Ğ•Ğ»ĞµĞ½Ğ° ĞšĞ¾Ğ·Ğ»Ğ¾Ğ²Ğ° Ñ‚ĞµĞ¿ĞµÑ€ÑŒ Ğ±ĞµĞ· ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸ (SetNull)");
    }
    
    static void PrintUniversityHierarchy(DataSet ds)
    {
        DataTable faculties = ds.Tables["Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹"];
        foreach (DataRow faculty in faculties.Rows)
        {
            Console.WriteLine($"ğŸ“š {faculty["FacultyName"]} (ID:{faculty["FacultyID"]})");
            
            DataRow[] specs = faculty.GetChildRows("Rel_Faculties_Specialties");
            foreach (DataRow spec in specs)
            {
                Console.WriteLine($"  â”œâ”€ {spec["SpecialtyName"]} (ID:{spec["SpecialtyID"]})");
                
                DataRow[] studs = spec.GetChildRows("Rel_Specialties_Students");
                foreach (DataRow stud in studs)
                {
                    Console.WriteLine($"  â”‚  â””â”€ {stud["StudentName"]} (ID:{stud["StudentID"]})");
                    
                    DataRow[] studGrades = stud.GetChildRows("Rel_Students_Grades");
                    Console.WriteLine($"  â”‚     â””â”€ ĞÑ†ĞµĞ½Ğ¾Ğº: {studGrades.Length}");
                }
            }
        }
    }
    
    static void GenerateUniversityReports(DataSet ds)
    {
        Console.WriteLine("\n=== ĞĞ¢Ğ§ĞĞ¢Ğ« ===");
        
        Console.WriteLine("\n1. ĞŸĞ Ğ¤ĞĞšĞ£Ğ›Ğ¬Ğ¢Ğ•Ğ¢ĞĞœ:");
        PrintFacultyReport(ds);
        
        Console.WriteLine("\n2. ĞŸĞ Ğ¡Ğ¢Ğ£Ğ”Ğ•ĞĞ¢ĞĞœ (ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ±Ğ°Ğ»Ğ»):");
        PrintStudentReport(ds);
        
        Console.WriteLine("\n3. Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ™:");
        PrintChangeReport(ds);
    }
    
    static void PrintFacultyReport(DataSet ds)
    {
        DataTable faculties = ds.Tables["Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚Ñ‹"];
        Console.WriteLine("Ğ¤Ğ°ĞºÑƒĞ»ÑŒÑ‚ĞµÑ‚         | Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ĞµĞ¹ | Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² | Ğ¡Ñ€.Ğ±Ğ°Ğ»Ğ»");
        Console.WriteLine("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        
        foreach (DataRow faculty in faculties.Rows)
        {
            DataRow[] specs = faculty.GetChildRows("Rel_Faculties_Specialties");
            int specCount = specs.Length;
            int studentCount = 0;
            double totalAvg = 0;
            
            foreach (DataRow spec in specs)
            {
                DataRow[] studs = spec.GetChildRows("Rel_Specialties_Students");
                studentCount += studs.Length;
                
                foreach (DataRow stud in studs)
                {
                    double studAvg = CalculateStudentAverage(ds, (int)stud["StudentID"]);
                    totalAvg += studAvg;
                }
            }
            
            double facultyAvg = studentCount > 0 ? totalAvg / studentCount : 0;
            Console.WriteLine($"{faculty["FacultyName"],-17} | {specCount,14} | {studentCount,9} | {facultyAvg,7:F2}");
        }
    }
    
    static void PrintStudentReport(DataSet ds)
    {
        DataTable students = ds.Tables["Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹"];
        Console.WriteLine("Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚             | Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ    | Ğ¡Ñ€.Ğ±Ğ°Ğ»Ğ» | ĞÑ†ĞµĞ½Ğ¾Ğº");
        Console.WriteLine("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        
        foreach (DataRow student in students.Rows)
        {
            double avg = CalculateStudentAverage(ds, (int)student["StudentID"]);
            DataRow[] grades = student.GetChildRows("Rel_Students_Grades");
            
            DataTable specialties = ds.Tables["Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"];
            DataRow[] specRows = specialties.Select($"SpecialtyID = {(int)student["SpecialtyID"]}");
            string specialtyName = specRows.Length > 0 ? (string)specRows[0]["SpecialtyName"] : "Ğ‘ĞµĞ· ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸";
            
            Console.WriteLine($"{student["StudentName"],-20} | {specialtyName,-16} | {avg,7:F2} | {grades.Length,7}");
        }
    }
    
    static double CalculateStudentAverage(DataSet ds, int studentID)
    {
        DataTable grades = ds.Tables["ĞÑ†ĞµĞ½ĞºĞ¸"];
        DataRow[] studentGrades = grades.Select($"StudentID = {studentID}");
        
        if (studentGrades.Length == 0) return 0;
        
        double sum = 0;
        foreach (DataRow grade in studentGrades)
            sum += (double)grade["Grade"];
        
        return sum / studentGrades.Length;
    }
    
    static void PrintChangeReport(DataSet ds)
    {
        Console.WriteLine("Ğ¡ĞĞ¡Ğ¢ĞĞ¯ĞĞ˜Ğ• Ğ˜Ğ—ĞœĞ•ĞĞ•ĞĞ˜Ğ™:");
        Console.WriteLine("Ğ¢Ğ°Ğ±Ğ»Ğ¸Ñ†Ğ°       | Added | Modified | Deleted");
        Console.WriteLine("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        
        foreach (DataTable table in ds.Tables)
        {
            int added = table.Select("", "", DataViewRowState.Added).Length;
            int modified = table.Select("", "", DataViewRowState.ModifiedCurrent).Length;
            int deleted = table.Select("", "", DataViewRowState.Deleted).Length;
            
            Console.WriteLine($"{table.TableName,-12} | {added,5} | {modified,8} | {deleted,7}");
        }
    }
    
    static void CheckUniversityIntegrity(DataSet ds)
    {
        Console.WriteLine("\nĞŸĞ ĞĞ’Ğ•Ğ ĞšĞ Ğ¡Ğ¡Ğ«Ğ›ĞĞ§ĞĞĞ™ Ğ¦Ğ•Ğ›ĞĞ¡Ğ¢ĞĞĞ¡Ğ¢Ğ˜:");
        Console.WriteLine("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        
        DataTable students = ds.Tables["Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ñ‹"];
        DataTable specialties = ds.Tables["Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸"];
        int orphans = 0;
        
        foreach (DataRow student in students.Rows)
        {
            if (student["SpecialtyID"] != DBNull.Value)
            {
                int specID = (int)student["SpecialtyID"];
                DataRow spec = specialties.Rows.Find(specID);
                if (spec == null) orphans++;
            }
        }
        
        Console.WriteLine($"Ğ¡Ñ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² Ğ±ĞµĞ· ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸: {orphans}");
        Console.WriteLine(orphans == 0 ? "âœ“ Ğ¦Ğ•Ğ›ĞĞ¡Ğ¢ĞĞĞ¡Ğ¢Ğ¬ ĞĞš" : "âš ï¸ ĞĞĞ Ğ£Ğ¨Ğ•ĞĞ˜Ğ¯ Ğ¦Ğ•Ğ›ĞĞ¡Ğ¢ĞĞĞ¡Ğ¢Ğ˜");
    }
}
